# Получение документов, размещаемых в ЕКИС по олимпиаде ВСОШ

### Суть реализации: Получить списки распределенных на МПО детей, протоколы и списки приглашенных детей на предстоящую дату олимпиады

1. [Установка](#установка)
2. [Предварительная настройка параметров в .env.dist](#предварительная-настройка)
3. [Запуск](#запуск)

---

## Установка

    При написании использовался Python 3.13

1. Качаем репозиторий:
    ```shell
    git clone https://github.com/dzenbots/olimpiada_from_ekis.git
    ```
2. Создаем вирутальное окружение, активируем его и устанавливаем зависимости:

    - для CMD:
    ```cmd
    python -m venv .venv
    .\.venv\scripts\activate.bat
    pip install -r requirements.txt
    ```
    - для Powershell
    ```powershell
    python -m venv .venv
    .\.venv\scripts\activate.ps1
    pip install -r requirements.txt
    ```
    - для Bash (Linux)
    ```shell
    python -m venv .venv
    source ./.venv/bin/activate
    pip install -r requirements.txt
    ```

3. Устанавливаем драйвер браузера для Playwright

    ```shell
    playwright install chromium
    ```

## Предварительная настройка параметров в [.env.dist](.env.dist)

Переименовываем (или копируем) файл `.env.dist` в `.env`

Заполняем переменные своими данными:

| Переменная          | Значение                                                                                                                                            |
|:--------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------|
| mayak_login         | Логин ЛК Маяк пользователя, имеющего права на доступ в ЕКИС (формы сбора)                                                                           | 
| mayak_password      | Пароль ЛК Маяк пользователя, имеющего права на доступ в ЕКИС (формы сбора)                                                                          |
| db_filename         | Имя файла базы данных. Можно не менять.                                                                                                             |
| storage_folder_path | Путь к локальной папке, куда будут скачиваться файлы                                                                                                |
| email_smtp_server   | Сервер для работы с почтой (у Яндекса smtp.yandex.ru)                                                                                               |
| email_smtp_port     | Порт почтового сервера (у Яндекса 465)                                                                                                              |
| email_smtp_login    | Почтовый адрес, с которого будет отправляться сообщение с файлом из ЕКИС                                                                              |
| email_smtp_password | Пароль почтового ящика, который выше. Возможно понадобится создать пароль для внешнего приложения и указывать именно его (у Яндекса это точно надо) |
| email_target_emails | Список почтовых адресов, куда отправить сообщение с файлом из МЦКО. Можно указать один адрес рассылки с нужными сотрудниками                        |
| debug               | `True` или `False` в зависимости от того, хотите ли вы наблюдать как там в браузере происходит переход по страницам и скачивание файлов             |

## Запуск

При активированном виртуальном окружении запускаем командой

```shell
python main.py
```

> [!TIP]
> Если будут баги или предложения по доработке - WELCOME!

